ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 1.
Hexadecimal [24-Bits]



                                      1 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                      2 ;
                                      3 ;  INVADERS FOR KRAFT 80
                                      4 ;  A mini game inspired on Taito's Space Invaders
                                      5 ;  Rev 1.0
                                      6 ;  14-Oct-2025 - ARMCoder
                                      7 ;  Main module
                                      8 ;
                                      9 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                     10 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 2.
Hexadecimal [24-Bits]



                                     11 		.include "defines.h"
                                      1 ;
                                      2 ; KRAFT80 Defines
                                      3 ;
                                      4 
                           004102     5 isr1vector	.equ	0x4102	;STACKTOP+2
                           004104     6 isr2vector	.equ	0x4104	;STACKTOP+4
                                      7 
                           000000     8 PORTBUTTONS	.equ	0x00	
                           000050     9 PORTDATA	.equ	0x50
                           000051    10 PORTADDRL	.equ	0x51
                           000052    11 PORTADDRH	.equ	0x52
                           000053    12 PORTMODE	.equ	0x53
                                     13 
                                     14 ;   PS2 KEYBOARD
                           000055    15 PORTKEY		.equ	0x55
                                     16 
                                     17 ;
                                     18 ; Game Defines
                                     19 ;
                                     20 
                           00000B    21 INVADER_COLS	.equ	11
                           000005    22 INVADER_ROWS	.equ	5
                           000037    23 INVADER_NUM	.equ	(INVADER_COLS*INVADER_ROWS)	
                           000008    24 INVADERS_VSPACING .equ	8
                                     25 
                           0000E0    26 PLAYFIELD_WIDTH	.equ	224
                                     27 
                           000070    28 PLAY_WIDTH_BYTES .equ	(PLAYFIELD_WIDTH/2)
                           00000C    29 VSTEP		.equ	12
                           000008    30 VSTEP2		.equ	INVADERS_VSPACING
                                     31 
                           0000A0    32 BYTES_PER_LINE	.equ	160
                                     33 
                           000018    34 LEFT_OFFSET_BYTES .equ	(BYTES_PER_LINE - PLAY_WIDTH_BYTES)/2
                                     35 
                                     36 
                           0000DC    37 CANNON_VPOS	.equ	220
                           008998    38 CANNON_SCR_OFS	.equ	(BYTES_PER_LINE*CANNON_VPOS+LEFT_OFFSET_BYTES)
                           008FD8    39 BLINE_SCR_OFS	.equ	(BYTES_PER_LINE*(10+CANNON_VPOS)+LEFT_OFFSET_BYTES)
                                     40 
                           007AA8    41 BUNKER1_SCR_OFS	.equ	(BYTES_PER_LINE*(CANNON_VPOS-24)+16+LEFT_OFFSET_BYTES)
                           007ABF    42 BUNKER2_SCR_OFS	.equ	(BUNKER1_SCR_OFS+23)
                           007AD6    43 BUNKER3_SCR_OFS	.equ	(BUNKER2_SCR_OFS+23)
                           007AED    44 BUNKER4_SCR_OFS	.equ	(BUNKER3_SCR_OFS+23)
                                     45 
                           000226    46 INV_DIVIDER_INI	 .equ	550
                           00000A    47 INV_DIVIDER_DROP .equ	10
                                     48 
                           000008    49 NUM_BOMBS	.equ	8
                                     50 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 3.
Hexadecimal [24-Bits]



                                     12 
                                     13 		.area	CODE
                                     14 
                                     15 		.globl	invader_matrix, col_start, col_end, row_end
                                     16 		.globl	cannon_hpos_px
                                     17 		.globl	cannondie_state
                                     18 
                                     19 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                     20 
      000000                         21 invaders:
      000000 CD 00 00         [17]   22 		call	set_screen
                                     23 
      000003 21 72 03         [10]   24 		ld	hl,#timer_service
      000006 CD 00 00         [17]   25 		call	init_timer
                                     26 
      000009 CD 00 00         [17]   27 		call	init_inputs
                                     28 
      00000C 21 96 00         [10]   29 		ld	hl,#150
      00000F 22 4B 00         [16]   30 		ld	(timer_invaders),hl
      000012 2A 4B 00         [16]   31 wait_init:	ld	hl,(timer_invaders)
      000015 7C               [ 4]   32 		ld	a,h
      000016 B5               [ 4]   33 		or	l
      000017 20 F9            [12]   34 		jr	nz,wait_init
                                     35 
      000019 CD 00 00         [17]   36 		call	clrscr
      00001C CD 00 00         [17]   37 		call	drawbaseline
                                     38 
      00001F CD 4E 00         [17]   39 		call	init_vars1
      000022 CD 74 00         [17]   40 		call	init_vars2
                                     41 
      000025 CD 00 00         [17]   42 		call	print_cannon
      000028 CD 00 00         [17]   43 		call	print_invaders
                                     44 
      00002B 21 00 00         [10]   45 		ld	hl,#0
      00002E 22 54 00         [16]   46 		ld	(score),hl
                                     47 
      000031 CD 50 05         [17]   48 		call	print_score
                                     49 
      000034                         50 loop_invaders:
      000034 CD 00 00         [17]   51 		call	update_inputs
      000037 32 00 00         [13]   52 		ld	(inputs_state),a
                                     53 
      00003A CD DC 02         [17]   54 		call	move_cannon
      00003D CD 78 02         [17]   55 		call	move_invaders
      000040 CD F4 01         [17]   56 		call	move_missile
      000043 CD D1 03         [17]   57 		call	newbomb
      000046 CD 94 04         [17]   58 		call	move_bombs
      000049 CD B0 03         [17]   59 		call	lfsr_update
      00004C 18 E6            [12]   60 		jr	loop_invaders
                                     61 
                                     62 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                     63 
      00004E                         64 init_vars1:
      00004E 3E 68            [ 7]   65 		ld	a,#(PLAYFIELD_WIDTH/2) - 8
      000050 32 01 00         [13]   66 		ld	(cannon_hpos_px),a
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 4.
Hexadecimal [24-Bits]



                                     67 
      000053 AF               [ 4]   68 		xor	a
      000054 32 05 00         [13]   69 		ld	(missile_act),a
      000057 32 50 00         [13]   70 		ld	(timer_missile),a
                                     71 
      00005A 06 08            [ 7]   72 		ld	b,#NUM_BOMBS
      00005C DD 21 57 00      [14]   73 		ld	ix,#bomb_basedata
      000060 DD 77 18         [19]   74 init_vars1a:	ld	_BOMB_ACT(ix),a
      000063 DD 23            [10]   75 		inc	ix
      000065 10 F9            [13]   76 		djnz	init_vars1a
                                     77 
      000067 32 87 00         [13]   78 		ld	(timer_bombs),a
      00006A 32 88 00         [13]   79 		ld	(timer_newbomb),a
                                     80 
      00006D 21 AF 51         [10]   81 		ld	hl,#0x51af
      000070 22 89 00         [16]   82 		ld	(lfsr_data),hl
                                     83 
      000073 C9               [10]   84 		ret
                                     85 
                                     86 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                     87 
      000074                         88 init_vars2:
      000074 CD 00 00         [17]   89 		call	print_bunkers
                                     90 
      000077 21 0B 00         [10]   91 		ld	hl,#invader_matrix
      00007A 3E 01            [ 7]   92 		ld	a,#1
      00007C 06 37            [ 7]   93 		ld	b,#INVADER_NUM
      00007E 77               [ 7]   94 init_var1:	ld	(hl),a
      00007F 23               [ 6]   95 		inc	hl
      000080 10 FC            [13]   96 		djnz	init_var1
                                     97 
      000082 3E 37            [ 7]   98 		ld	a,#INVADER_NUM
      000084 32 42 00         [13]   99 		ld	(invader_count),a
                                    100 
      000087 AF               [ 4]  101 		xor	a
      000088 32 45 00         [13]  102 		ld	(col_start),a
      00008B 32 00 00         [13]  103 		ld	(stepping),a
      00008E 32 0A 00         [13]  104 		ld	(hdir_invaders),a
      000091 32 53 00         [13]  105 		ld	(refsh_cannon),a
                                    106 
      000094 3E 0A            [ 7]  107 		ld	a,#INVADER_COLS-1
      000096 32 46 00         [13]  108 		ld	(col_end),a
      000099 3E 04            [ 7]  109 		ld	a,#INVADER_ROWS-1
      00009B 32 48 00         [13]  110 		ld	(row_end),a
                                    111 
      00009E 21 26 02         [10]  112 		ld	hl,#INV_DIVIDER_INI
      0000A1 22 4D 00         [16]  113 		ld	(invaders_divider),hl
      0000A4 22 49 00         [16]  114 		ld	(timer_div),hl
                                    115 
      0000A7 3E 18            [ 7]  116 		ld	a,#24
      0000A9 32 08 00         [13]  117 		ld	(row_invaders),a
      0000AC 3E 20            [ 7]  118 		ld	a,#32
      0000AE 32 09 00         [13]  119 		ld	(col_invaders_px),a
                                    120 
      0000B1 21 00 00         [10]  121 		ld	hl,#0
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 5.
Hexadecimal [24-Bits]



      0000B4 22 4B 00         [16]  122 		ld	(timer_invaders),hl
      0000B7 22 51 00         [16]  123 		ld	(cannondie_state),hl
                                    124 
      0000BA CD D1 01         [17]  125 		call	update_scrpos
                                    126 
      0000BD C9               [10]  127 		ret
                                    128 
                                    129 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    130 
      0000BE 06 05            [ 7]  131 check_hit:	ld	b,#INVADER_ROWS		
                                    132 
      0000C0 21 0B 00         [10]  133 		ld	hl,#invader_matrix
      0000C3 3A 45 00         [13]  134 		ld	a,(col_start)
      0000C6 5F               [ 4]  135 		ld	e,a
      0000C7 16 00            [ 7]  136 		ld	d,#0
      0000C9 19               [11]  137 		add	hl,de
                                    138 
      0000CA 3A 08 00         [13]  139 		ld	a,(row_invaders)
      0000CD 57               [ 4]  140 		ld	d,a
      0000CE C6 08            [ 7]  141 		add	a,#8
      0000D0 5F               [ 4]  142 		ld	e,a
                                    143 
      0000D1 3A 04 00         [13]  144 scan_invrows:	ld	a,(missile_vpos)
      0000D4 BA               [ 4]  145 		cp	d
      0000D5 38 05            [12]  146 		jr	c,invr_nf
      0000D7 BB               [ 4]  147 		cp	e
      0000D8 30 02            [12]  148 		jr	nc,invr_nf
                                    149 
      0000DA 18 11            [12]  150 		jr	invr_foundrow
                                    151 
      0000DC 7A               [ 4]  152 invr_nf:	ld	a,d
      0000DD C6 10            [ 7]  153 		add	#(8+INVADERS_VSPACING)
      0000DF 57               [ 4]  154 		ld	d,a
                                    155 		
      0000E0 7B               [ 4]  156 		ld	a,e
      0000E1 C6 10            [ 7]  157 		add	#(8+INVADERS_VSPACING)
      0000E3 5F               [ 4]  158 		ld	e,a
                                    159 
      0000E4 D5               [11]  160 		push	de
      0000E5 11 0B 00         [10]  161 		ld	de,#INVADER_COLS
      0000E8 19               [11]  162 		add	hl,de
      0000E9 D1               [10]  163 		pop	de
                                    164 
      0000EA 10 E5            [13]  165 		djnz	scan_invrows
      0000EC C9               [10]  166 		ret
                                    167 
      0000ED 3E 1E            [ 7]  168 invr_foundrow:	ld	a,#30
      0000EF 32 56 00         [13]  169 		ld	(scrinc),a
      0000F2 78               [ 4]  170 		ld	a,b	; Check the row for scoring (top row:30 pts  mid rows:20 pts  lower rows: 10 pts)
      0000F3 FE 05            [ 7]  171 		cp	#INVADER_ROWS
      0000F5 28 13            [12]  172 		jr	z,invr_foundrow2
      0000F7 3E 14            [ 7]  173 		ld	a,#20
      0000F9 32 56 00         [13]  174 		ld	(scrinc),a
      0000FC 78               [ 4]  175 		ld	a,b
      0000FD FE 04            [ 7]  176 		cp	#INVADER_ROWS-1
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 6.
Hexadecimal [24-Bits]



      0000FF 28 09            [12]  177 		jr	z,invr_foundrow2
      000101 FE 03            [ 7]  178 		cp	#INVADER_ROWS-2
      000103 28 05            [12]  179 		jr	z,invr_foundrow2
      000105 3E 0A            [ 7]  180 		ld	a,#10
      000107 32 56 00         [13]  181 		ld	(scrinc),a
                                    182 		
      00010A                        183 invr_foundrow2:
      00010A 06 0B            [ 7]  184 		ld	b,#INVADER_COLS
                                    185 
      00010C 3A 09 00         [13]  186 		ld	a,(col_invaders_px)
      00010F 57               [ 4]  187 		ld	d,a
      000110 C6 10            [ 7]  188 		add	a,#16
      000112 5F               [ 4]  189 		ld	e,a
                                    190 
      000113 3A 02 00         [13]  191 scan_invcols:	ld	a,(missile_hpos_px)
      000116 BA               [ 4]  192 		cp	d
      000117 38 05            [12]  193 		jr	c,invr_nf2
      000119 BB               [ 4]  194 		cp	e
      00011A 30 02            [12]  195 		jr	nc,invr_nf2
                                    196 
      00011C 18 0C            [12]  197 		jr	invr_foundcol
                                    198 
      00011E 7A               [ 4]  199 invr_nf2:	ld	a,d
      00011F C6 10            [ 7]  200 		add	#16
      000121 57               [ 4]  201 		ld	d,a
                                    202 		
      000122 7B               [ 4]  203 		ld	a,e
      000123 C6 10            [ 7]  204 		add	#16
      000125 5F               [ 4]  205 		ld	e,a
                                    206 
      000126 23               [ 6]  207 		inc	hl
      000127 10 EA            [13]  208 		djnz	scan_invcols
      000129 C9               [10]  209 		ret
                                    210 
      00012A 7E               [ 7]  211 invr_foundcol:	ld	a,(hl)
      00012B B7               [ 4]  212 		or	a
      00012C C8               [11]  213 		ret	z
                                    214 
      00012D 36 00            [10]  215 		ld	(hl),#0
                                    216 
      00012F 2A 54 00         [16]  217 		ld	hl,(score)
      000132 3A 56 00         [13]  218 		ld	a,(scrinc)
      000135 5F               [ 4]  219 		ld	e,a
      000136 16 00            [ 7]  220 		ld	d,#0
      000138 19               [11]  221 		add	hl,de
      000139 22 54 00         [16]  222 		ld	(score),hl
      00013C CD 50 05         [17]  223 		call	print_score
                                    224 
      00013F CD 00 00         [17]  225 		call	print_invaders
                                    226 
      000142 2A 4D 00         [16]  227 		ld	hl,(invaders_divider)
      000145 11 F6 FF         [10]  228 		ld	de,#-INV_DIVIDER_DROP
      000148 19               [11]  229 		add	hl,de
      000149 22 4D 00         [16]  230 		ld	(invaders_divider),hl
                                    231 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 7.
Hexadecimal [24-Bits]



      00014C 3A 42 00         [13]  232 		ld	a,(invader_count)
      00014F 3D               [ 4]  233 		dec	a
      000150 32 42 00         [13]  234 		ld	(invader_count),a
      000153 20 07            [12]  235 		jr	nz,check_cols_r
                                    236 
      000155 CD 74 00         [17]  237 		call	init_vars2
      000158 CD 00 00         [17]  238 		call	print_invaders
      00015B C9               [10]  239 		ret
                                    240 
      00015C 3A 46 00         [13]  241 check_cols_r:	ld	a,(col_end)
      00015F 5F               [ 4]  242 		ld	e,a
      000160 16 00            [ 7]  243 		ld	d,#0
      000162 21 0B 00         [10]  244 		ld	hl,#invader_matrix
      000165 19               [11]  245 		add	hl,de
      000166 06 05            [ 7]  246 		ld	b,#INVADER_ROWS
      000168 1E 0B            [ 7]  247 		ld	e,#INVADER_COLS
      00016A 7E               [ 7]  248 check_cols_r2:	ld	a,(hl)
      00016B B7               [ 4]  249 		or	a
      00016C 20 0C            [12]  250 		jr	nz,check_cols_l
      00016E 19               [11]  251 		add	hl,de
      00016F 10 F9            [13]  252 		djnz	check_cols_r2
      000171 3A 46 00         [13]  253 		ld	a,(col_end)
      000174 3D               [ 4]  254 		dec	a
      000175 32 46 00         [13]  255 		ld	(col_end),a
      000178 18 E2            [12]  256 		jr	check_cols_r
                                    257 		
      00017A 3A 45 00         [13]  258 check_cols_l:	ld	a,(col_start)
      00017D 5F               [ 4]  259 		ld	e,a
      00017E 21 0B 00         [10]  260 		ld	hl,#invader_matrix
      000181 19               [11]  261 		add	hl,de
      000182 06 05            [ 7]  262 		ld	b,#INVADER_ROWS
      000184 1E 0B            [ 7]  263 		ld	e,#INVADER_COLS
      000186 7E               [ 7]  264 check_cols_l2:	ld	a,(hl)
      000187 B7               [ 4]  265 		or	a
      000188 20 17            [12]  266 		jr	nz,check_rows
                                    267 
      00018A 19               [11]  268 		add	hl,de
      00018B 10 F9            [13]  269 		djnz	check_cols_l2
      00018D 3A 45 00         [13]  270 		ld	a,(col_start)
      000190 3C               [ 4]  271 		inc	a
      000191 32 45 00         [13]  272 		ld	(col_start),a
                                    273 		
      000194 3A 09 00         [13]  274 		ld	a,(col_invaders_px)
      000197 C6 10            [ 7]  275 		add	a,#16
      000199 32 09 00         [13]  276 		ld	(col_invaders_px),a
      00019C CD D1 01         [17]  277 		call	update_scrpos
                                    278 		
      00019F 18 D9            [12]  279 		jr	check_cols_l
                                    280 
      0001A1 3A 48 00         [13]  281 check_rows:	ld	a,(row_end)
      0001A4 B7               [ 4]  282 		or	a
      0001A5 C8               [11]  283 		ret	z
                                    284 
      0001A6 47               [ 4]  285 		ld	b,a
      0001A7 21 37 00         [10]  286 		ld	hl,#invader_matrix+(INVADER_ROWS-1)*(INVADER_COLS)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 8.
Hexadecimal [24-Bits]



      0001AA 11 F5 FF         [10]  287 		ld	de,#-INVADER_COLS
      0001AD 19               [11]  288 chkrow0:	add	hl,de
      0001AE 10 FD            [13]  289 		djnz	chkrow0
                                    290 		
      0001B0 3A 48 00         [13]  291 		ld	a,(row_end)
      0001B3 4F               [ 4]  292 		ld	c,a		
                                    293 
      0001B4 22 43 00         [16]  294 chkrow2:	ld	(invader_matnow),hl
      0001B7 06 0B            [ 7]  295 		ld	b,#INVADER_COLS
                                    296 
      0001B9 7E               [ 7]  297 chkrow1:	ld	a,(hl)
      0001BA B7               [ 4]  298 		or	a
      0001BB C0               [11]  299 		ret	nz
                                    300 
      0001BC 23               [ 6]  301 		inc	hl
      0001BD 10 FA            [13]  302 		djnz	chkrow1
                                    303 
      0001BF 3A 48 00         [13]  304 		ld	a,(row_end)
      0001C2 3D               [ 4]  305 		dec	a
      0001C3 32 48 00         [13]  306 		ld	(row_end),a
                                    307 
      0001C6 2A 43 00         [16]  308 		ld	hl,(invader_matnow)
      0001C9 11 F5 FF         [10]  309 		ld	de,#-INVADER_COLS
      0001CC 19               [11]  310 		add	hl,de
                                    311 
      0001CD 0D               [ 4]  312 		dec	c
      0001CE 20 E4            [12]  313 		jr	nz,chkrow2
      0001D0 C9               [10]  314 		ret
                                    315 
                                    316 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    317 
      0001D1 3A 08 00         [13]  318 update_scrpos:	ld	a,(row_invaders)	; Pixel line
      0001D4 21 00 00         [10]  319 		ld	hl,#0
      0001D7 B7               [ 4]  320 		or	a
      0001D8 28 07            [12]  321 		jr	z,update1a
      0001DA 11 A0 00         [10]  322 		ld	de,#BYTES_PER_LINE
      0001DD 19               [11]  323 update1:	add	hl,de
      0001DE 3D               [ 4]  324 		dec	a
      0001DF 20 FC            [12]  325 		jr	nz,update1
                                    326 	
      0001E1 54               [ 4]  327 update1a:	ld	d,h
      0001E2 5D               [ 4]  328 		ld	e,l
      0001E3 3A 09 00         [13]  329 		ld	a,(col_invaders_px)
      0001E6 CB 3F            [ 8]  330 		srl	a
      0001E8 6F               [ 4]  331 		ld	l,a
      0001E9 26 00            [ 7]  332 		ld	h,#0
      0001EB 19               [11]  333 		add	hl,de
      0001EC 11 18 00         [10]  334 		ld	de,#LEFT_OFFSET_BYTES
      0001EF 19               [11]  335 		add	hl,de
      0001F0 22 00 00         [16]  336 		ld	(scrpos_invaders),hl
                                    337 
      0001F3 C9               [10]  338 		ret
                                    339 
                                    340 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    341 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 9.
Hexadecimal [24-Bits]



      0001F4 3A 50 00         [13]  342 move_missile:	ld	a,(timer_missile)
      0001F7 B7               [ 4]  343 		or	a
      0001F8 C0               [11]  344 		ret	nz
      0001F9 3E 03            [ 7]  345 		ld	a,#3
      0001FB 32 50 00         [13]  346 		ld	(timer_missile),a
                                    347 
      0001FE 3A 05 00         [13]  348 		ld	a,(missile_act)
      000201 FE 01            [ 7]  349 		cp	#1
      000203 C0               [11]  350 		ret	nz
                                    351 
      000204 3A 04 00         [13]  352 		ld	a,(missile_vpos)
      000207 FE 08            [ 7]  353 		cp	#8
      000209 30 0C            [12]  354 		jr	nc,movem1
                                    355 
      00020B 3E 02            [ 7]  356 		ld	a,#2
      00020D 32 05 00         [13]  357 		ld	(missile_act),a
      000210 2A 06 00         [16]  358 		ld	hl,(missile_scrpos)
      000213 0E 00            [ 7]  359 		ld	c,#0
      000215 18 30            [12]  360 		jr	movem2
                                    361 
      000217 3D               [ 4]  362 movem1:		dec	a
      000218 3D               [ 4]  363 		dec	a
      000219 32 04 00         [13]  364 		ld	(missile_vpos),a
                                    365 		
      00021C 2A 06 00         [16]  366 		ld	hl,(missile_scrpos)
      00021F 11 C0 FE         [10]  367 		ld	de,#-(2*BYTES_PER_LINE)
      000222 19               [11]  368 		add	hl,de
      000223 22 06 00         [16]  369 		ld	(missile_scrpos),hl
                                    370 
      000226 3A 03 00         [13]  371 		ld	a,(missile_pixmask)
      000229 E6 EE            [ 7]  372 		and	#0xee
      00022B 4F               [ 4]  373 		ld	c,a
                                    374 		
      00022C 7D               [ 4]  375 		ld	a,l
      00022D D3 51            [11]  376 		out	(PORTADDRL),a
      00022F 7C               [ 4]  377 		ld	a,h
      000230 D3 52            [11]  378 		out	(PORTADDRH),a
                                    379 
      000232 3A 03 00         [13]  380 		ld	a,(missile_pixmask)
      000235 57               [ 4]  381 		ld	d,a
      000236 DB 50            [11]  382 		in	a,(PORTDATA)
      000238 A2               [ 4]  383 		and	d
      000239 28 0C            [12]  384 		jr	z,movem2
                                    385 
      00023B E5               [11]  386 		push	hl
      00023C CD BE 00         [17]  387 		call	check_hit		; Missile hit something
      00023F E1               [10]  388 		pop	hl
                                    389 		
      000240 3E 02            [ 7]  390 		ld	a,#2	
      000242 32 05 00         [13]  391 		ld 	(missile_act),a
      000245 0E 00            [ 7]  392 		ld	c,#0
                                    393 		
      000247 06 05            [ 7]  394 movem2:		ld	b,#5
      000249 11 A0 00         [10]  395 		ld	de,#BYTES_PER_LINE
                                    396 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 10.
Hexadecimal [24-Bits]



      00024C 7D               [ 4]  397 movem3:		ld	a,l
      00024D D3 51            [11]  398 		out	(PORTADDRL),a
      00024F 7C               [ 4]  399 		ld	a,h
      000250 D3 52            [11]  400 		out	(PORTADDRH),a
      000252 C5               [11]  401 		push	bc
      000253 DB 50            [11]  402 		in	a,(PORTDATA)
      000255 47               [ 4]  403 		ld	b,a
      000256 3A 03 00         [13]  404 		ld	a,(missile_pixmask)
      000259 2F               [ 4]  405 		cpl
      00025A A0               [ 4]  406 		and	b
      00025B B1               [ 4]  407 		or	c
      00025C C1               [10]  408 		pop	bc
      00025D D3 50            [11]  409 		out	(PORTDATA),a
      00025F 19               [11]  410 		add	hl,de
      000260 10 EA            [13]  411 		djnz	movem3
                                    412 
      000262 06 02            [ 7]  413 		ld	b,#2
      000264 3A 03 00         [13]  414 		ld	a,(missile_pixmask)
      000267 2F               [ 4]  415 		cpl
      000268 4F               [ 4]  416 		ld	c,a
      000269 7D               [ 4]  417 movem4:		ld	a,l
      00026A D3 51            [11]  418 		out	(PORTADDRL),a
      00026C 7C               [ 4]  419 		ld	a,h
      00026D D3 52            [11]  420 		out	(PORTADDRH),a
      00026F DB 50            [11]  421 		in	a,(PORTDATA)
      000271 A1               [ 4]  422 		and	c
      000272 D3 50            [11]  423 		out	(PORTDATA),a
      000274 19               [11]  424 		add	hl,de
      000275 10 F2            [13]  425 		djnz	movem4
      000277 C9               [10]  426 		ret
                                    427 		
                                    428 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    429 
      000278 2A 4B 00         [16]  430 move_invaders:	ld	hl,(timer_invaders)
      00027B 7C               [ 4]  431 		ld	a,h
      00027C B5               [ 4]  432 		or	l
      00027D C0               [11]  433 		ret	nz
      00027E 2A 4D 00         [16]  434 		ld	hl,(invaders_divider)
      000281 22 4B 00         [16]  435 		ld	(timer_invaders),hl
                                    436 		
      000284 3A 00 00         [13]  437 		ld	a,(stepping)
      000287 06 01            [ 7]  438 		ld	b,#1
      000289 A8               [ 4]  439 		xor	b
      00028A 32 00 00         [13]  440 		ld	(stepping),a
                                    441 
      00028D 3A 0A 00         [13]  442 		ld	a,(hdir_invaders)
      000290 B7               [ 4]  443 		or	a
      000291 28 0D            [12]  444 		jr	z,moveright
                                    445 
      000293 3A 09 00         [13]  446 		ld	a,(col_invaders_px)	; Moving left
      000296 B7               [ 4]  447 		or	a
      000297 28 2A            [12]  448 		jr	z,revdir
                                    449 		
      000299 3D               [ 4]  450 		dec	a
      00029A 3D               [ 4]  451 		dec	a
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 11.
Hexadecimal [24-Bits]



      00029B 32 09 00         [13]  452 		ld	(col_invaders_px),a
      00029E 18 1D            [12]  453 		jr	movupd
                                    454 		
      0002A0                        455 moveright:
      0002A0 3A 45 00         [13]  456 		ld	a,(col_start)
      0002A3 47               [ 4]  457 		ld	b,a
      0002A4 3A 46 00         [13]  458 		ld	a,(col_end)
      0002A7 90               [ 4]  459 		sub	b
      0002A8 3C               [ 4]  460 		inc	a
      0002A9 87               [ 4]  461 		add	a,a
      0002AA 87               [ 4]  462 		add	a,a
      0002AB 87               [ 4]  463 		add	a,a
      0002AC 87               [ 4]  464 		add	a,a
      0002AD 47               [ 4]  465 		ld	b,a
      0002AE 3E E0            [ 7]  466 		ld	a,#PLAYFIELD_WIDTH
      0002B0 90               [ 4]  467 		sub	b
      0002B1 47               [ 4]  468 		ld	b,a
      0002B2 3A 09 00         [13]  469 		ld	a,(col_invaders_px)
      0002B5 B8               [ 4]  470 		cp	b
      0002B6 28 0B            [12]  471 		jr	z,revdir
                                    472 
      0002B8 3C               [ 4]  473 		inc	a
      0002B9 3C               [ 4]  474 		inc	a
      0002BA 32 09 00         [13]  475 		ld	(col_invaders_px),a
                                    476 
      0002BD CD D1 01         [17]  477 movupd:		call	update_scrpos
      0002C0 C3 00 00         [10]  478 		jp	print_invaders
                                    479 
      0002C3 3A 0A 00         [13]  480 revdir:		ld	a,(hdir_invaders)
      0002C6 EE 01            [ 7]  481 		xor	#1
      0002C8 32 0A 00         [13]  482 		ld	(hdir_invaders),a
      0002CB 3A 08 00         [13]  483 		ld	a,(row_invaders)
      0002CE C6 0C            [ 7]  484 		add	a,#VSTEP
      0002D0 32 08 00         [13]  485 		ld	(row_invaders),a
      0002D3 CD D1 01         [17]  486 		call	update_scrpos
      0002D6 CD 00 00         [17]  487 		call	print_invaders
      0002D9 C3 00 00         [10]  488 		jp	clear_lines
                                    489 
                                    490 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    491 
      0002DC                        492 move_cannon:
      0002DC 3A 4F 00         [13]  493 		ld	a,(timer_cannon)
      0002DF B7               [ 4]  494 		or	a
      0002E0 C0               [11]  495 		ret	nz
                                    496 		
      0002E1 3E 04            [ 7]  497 		ld	a,#4
      0002E3 32 4F 00         [13]  498 		ld	(timer_cannon),a
                                    499 
      0002E6 2A 51 00         [16]  500 		ld	hl,(cannondie_state)
      0002E9 7C               [ 4]  501 		ld	a,h
      0002EA B5               [ 4]  502 		or	l
      0002EB 28 08            [12]  503 		jr	z,movecan00
      0002ED 3E 01            [ 7]  504 		ld	a,#1
      0002EF 32 53 00         [13]  505 		ld	(refsh_cannon),a
      0002F2 C3 00 00         [10]  506 		jp	print_cannon_die
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 12.
Hexadecimal [24-Bits]



                                    507 
      0002F5                        508 movecan00:
      0002F5 3A 53 00         [13]  509 		ld	a,(refsh_cannon)
      0002F8 B7               [ 4]  510 		or	a
      0002F9 28 07            [12]  511 		jr	z,movecan001
      0002FB CD 00 00         [17]  512 		call	print_cannon
      0002FE AF               [ 4]  513 		xor	a
      0002FF 32 53 00         [13]  514 		ld	(refsh_cannon),a
                                    515 
      000302                        516 movecan001:
      000302 3A 00 00         [13]  517 		ld	a,(inputs_state)
      000305 4F               [ 4]  518 		ld	c,a
      000306 CB 47            [ 8]  519 		bit	0,a			;FIRE
      000308 20 0F            [12]  520 		jr	nz,newmis1		;Pressed
                                    521 
      00030A 3A 05 00         [13]  522 		ld	a,(missile_act)		;Not pressed
      00030D FE 02            [ 7]  523 		cp	#2
      00030F 79               [ 4]  524 		ld	a,c
      000310 20 3D            [12]  525 		jr	nz,movec0
      000312 AF               [ 4]  526 		xor	a
      000313 32 05 00         [13]  527 		ld	(missile_act),a
      000316 79               [ 4]  528 		ld	a,c
      000317 18 36            [12]  529 		jr	movec0
                                    530 		
      000319 3A 05 00         [13]  531 newmis1:	ld	a,(missile_act)
      00031C B7               [ 4]  532 		or	a
      00031D 79               [ 4]  533 		ld	a,c
      00031E 20 2F            [12]  534 		jr	nz,movec0
                                    535 
      000320 3E 01            [ 7]  536 		ld	a,#1
      000322 32 05 00         [13]  537 		ld	(missile_act),a
                                    538 		
      000325 3E DC            [ 7]  539 		ld	a,#CANNON_VPOS
      000327 D6 05            [ 7]  540 		sub	a,#5
      000329 32 04 00         [13]  541 		ld	(missile_vpos),a
      00032C 3A 01 00         [13]  542 		ld	a,(cannon_hpos_px)
      00032F C6 07            [ 7]  543 		add	a,#7
      000331 32 02 00         [13]  544 		ld	(missile_hpos_px),a
                                    545 		
      000334 06 0F            [ 7]  546 		ld	b,#0x0f
      000336 CB 47            [ 8]  547 		bit	0,a
      000338 28 02            [12]  548 		jr	z,newmis2
      00033A 06 F0            [ 7]  549 		ld	b,#0xf0
                                    550 
      00033C 57               [ 4]  551 newmis2:	ld	d,a
      00033D 78               [ 4]  552 		ld	a,b
      00033E 32 03 00         [13]  553 		ld	(missile_pixmask),a
                                    554 
      000341 7A               [ 4]  555 		ld	a,d
      000342 CB 3F            [ 8]  556 		srl	a
      000344 5F               [ 4]  557 		ld	e,a
      000345 16 00            [ 7]  558 		ld	d,#0
      000347 21 78 86         [10]  559 		ld	hl,#CANNON_SCR_OFS-(5*BYTES_PER_LINE)
      00034A 19               [11]  560 		add	hl,de
                                    561 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 13.
Hexadecimal [24-Bits]



      00034B 22 06 00         [16]  562 		ld	(missile_scrpos),hl
      00034E 79               [ 4]  563 		ld	a,c
                                    564 		
      00034F CB 6F            [ 8]  565 movec0:		bit	5,a			;LEFT
      000351 28 0F            [12]  566 		jr	z,movec1		;Not pressed
      000353 CB 7F            [ 8]  567 		bit	7,a			;RIGHT pressed
      000355 C0               [11]  568 		ret	nz
                                    569 		
      000356 3A 01 00         [13]  570 		ld	a,(cannon_hpos_px)	;decrement
      000359 B7               [ 4]  571 		or	a
      00035A C8               [11]  572 		ret	z
                                    573 
      00035B 3D               [ 4]  574 		dec	a
      00035C 32 01 00         [13]  575 		ld	(cannon_hpos_px),a
      00035F C3 00 00         [10]  576 		jp	print_cannon
                                    577 		
      000362 CB 7F            [ 8]  578 movec1:		bit	7,a			;RIGHT
      000364 C8               [11]  579 		ret	z			;NOT PRESSED
                                    580 
      000365 3A 01 00         [13]  581 		ld	a,(cannon_hpos_px)
      000368 FE D0            [ 7]  582 		cp	#(PLAYFIELD_WIDTH - 16)
      00036A D0               [11]  583 		ret	nc
      00036B 3C               [ 4]  584 		inc	a
      00036C 32 01 00         [13]  585 		ld	(cannon_hpos_px),a
      00036F C3 00 00         [10]  586 		jp	print_cannon
                                    587 
                                    588 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    589 
      000372 2A 4B 00         [16]  590 timer_service:	ld	hl,(timer_invaders)
      000375 7C               [ 4]  591 		ld	a,h
      000376 B5               [ 4]  592 		or	l
      000377 28 04            [12]  593 		jr	z,timer_isr2
      000379 2B               [ 6]  594 		dec	hl
      00037A 22 4B 00         [16]  595 		ld	(timer_invaders),hl
                                    596 		
      00037D 3A 4F 00         [13]  597 timer_isr2:	ld	a,(timer_cannon)
      000380 B7               [ 4]  598 		or	a
      000381 28 04            [12]  599 		jr	z,timer_isr3
                                    600 
      000383 3D               [ 4]  601 		dec	a
      000384 32 4F 00         [13]  602 		ld	(timer_cannon),a
                                    603 
      000387 3A 50 00         [13]  604 timer_isr3:	ld	a,(timer_missile)
      00038A B7               [ 4]  605 		or	a
      00038B 28 04            [12]  606 		jr	z,timer_isr4
      00038D 3D               [ 4]  607 		dec	a
      00038E 32 50 00         [13]  608 		ld	(timer_missile),a
                                    609 	
      000391 3A 87 00         [13]  610 timer_isr4:	ld	a,(timer_bombs)
      000394 B7               [ 4]  611 		or	a
      000395 28 04            [12]  612 		jr	z,timer_isr5
      000397 3D               [ 4]  613 		dec	a
      000398 32 87 00         [13]  614 		ld	(timer_bombs),a
                                    615 
      00039B 3A 88 00         [13]  616 timer_isr5:	ld	a,(timer_newbomb)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 14.
Hexadecimal [24-Bits]



      00039E B7               [ 4]  617 		or	a
      00039F 28 04            [12]  618 		jr	z,timer_isr6
      0003A1 3D               [ 4]  619 		dec	a
      0003A2 32 88 00         [13]  620 		ld	(timer_newbomb),a
                                    621 
      0003A5 2A 51 00         [16]  622 timer_isr6:	ld	hl,(cannondie_state)
      0003A8 7C               [ 4]  623 		ld	a,h
      0003A9 B5               [ 4]  624 		or	l
      0003AA C8               [11]  625 		ret	z
      0003AB 2B               [ 6]  626 		dec	hl
      0003AC 22 51 00         [16]  627 		ld	(cannondie_state),hl
                                    628 
      0003AF C9               [10]  629 		ret
                                    630 
                                    631 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    632 
                                    633 ; Fibonacci LFSR
                                    634 ; New bit[0] = bit[10] ^ bit[12] ^ bit[13] ^ bit[15]
                                    635 
      0003B0 2A 89 00         [16]  636 lfsr_update:	ld	hl,(lfsr_data)
                                    637 
      0003B3 37               [ 4]  638 		scf
      0003B4 3F               [ 4]  639 		ccf
                                    640 		
      0003B5 CB 7C            [ 8]  641 		bit	7,h
      0003B7 28 01            [12]  642 		jr	z,lfsr1
      0003B9 3F               [ 4]  643 		ccf
      0003BA CB 6C            [ 8]  644 lfsr1:		bit	5,h
      0003BC 28 01            [12]  645 		jr	z,lfsr2
      0003BE 3F               [ 4]  646 		ccf
      0003BF CB 64            [ 8]  647 lfsr2:		bit	4,h
      0003C1 28 01            [12]  648 		jr	z,lfsr3
      0003C3 3F               [ 4]  649 		ccf
      0003C4 CB 54            [ 8]  650 lfsr3:		bit	2,h
      0003C6 28 01            [12]  651 		jr	z,lfsr4
      0003C8 3F               [ 4]  652 		ccf
      0003C9 CB 15            [ 8]  653 lfsr4:		rl	l
      0003CB CB 14            [ 8]  654 		rl	h
      0003CD 22 89 00         [16]  655 		ld	(lfsr_data),hl
      0003D0 C9               [10]  656 		ret
                                    657 
                                    658 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    659 
      0003D1                        660 newbomb:
      0003D1 2A 51 00         [16]  661 		ld	hl,(cannondie_state)	;If dying, stop launching new bombs
      0003D4 7C               [ 4]  662 		ld	a,h
      0003D5 B5               [ 4]  663 		or	l
      0003D6 C0               [11]  664 		ret	nz
                                    665 
      0003D7 DD 21 57 00      [14]  666 		ld	ix,#bomb_basedata
      0003DB 06 08            [ 7]  667 		ld	b,#NUM_BOMBS
                                    668 
      0003DD C5               [11]  669 newbomb1:	push	bc
      0003DE CD E7 03         [17]  670 		call	 newbomb_ix
      0003E1 DD 23            [10]  671 		inc	ix
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 15.
Hexadecimal [24-Bits]



      0003E3 C1               [10]  672 		pop	bc
      0003E4 10 F7            [13]  673 		djnz	newbomb1
                                    674 
      0003E6 C9               [10]  675 		ret
                                    676 
      0003E7                        677 newbomb_ix:
      0003E7 3A 88 00         [13]  678 		ld	a,(timer_newbomb)
      0003EA B7               [ 4]  679 		or	a
      0003EB C0               [11]  680 		ret	nz
      0003EC 3E 32            [ 7]  681 		ld	a,#50
      0003EE 32 88 00         [13]  682 		ld	(timer_newbomb),a
                                    683 
      0003F1 DD 7E 18         [19]  684 		ld	a,_BOMB_ACT(ix)
      0003F4 B7               [ 4]  685 		or	a
      0003F5 C0               [11]  686 		ret	nz
                                    687 
                                    688 		;ld	a,(col_start)
      0003F6 3A 89 00         [13]  689 		ld	a,(lfsr_data)
      0003F9 FE 0B            [ 7]  690 newbomb0:	cp	#INVADER_COLS
      0003FB 38 04            [12]  691 		jr	c,newbomb1a
      0003FD D6 0B            [ 7]  692 		sub	#INVADER_COLS
      0003FF 18 F8            [12]  693 		jr	newbomb0
                                    694 
      000401                        695 newbomb1a:
      000401 32 47 00         [13]  696 		ld	(col_now),a
                                    697 
      000404 CD 72 04         [17]  698 		call	nb_testcol
                                    699 
      000407 7A               [ 4]  700 		ld	a,d
      000408 B7               [ 4]  701 		or	a
      000409 C8               [11]  702 		ret	z
                                    703 
      00040A 3A 08 00         [13]  704 		ld	a,(row_invaders)
      00040D C6 0C            [ 7]  705 		add	a,#0x0c
      00040F DD 77 10         [19]  706 		ld	_BOMB_VPOS(ix),a
                                    707 
      000412 7B               [ 4]  708 		ld	a,e
      000413 B7               [ 4]  709 		or	a
      000414 28 0B            [12]  710 		jr	z,newbomb2
      000416 43               [ 4]  711 		ld	b,e
      000417 DD 7E 10         [19]  712 		ld	a,_BOMB_VPOS(ix)
                                    713 		
      00041A C6 10            [ 7]  714 newbomb1b:	add	#(8+INVADERS_VSPACING)
      00041C 10 FC            [13]  715 		djnz	newbomb1b
                                    716 
      00041E DD 77 10         [19]  717 		ld	_BOMB_VPOS(ix),a
                                    718 
      000421                        719 newbomb2:
      000421 3A 45 00         [13]  720 		ld	a,(col_start)
      000424 47               [ 4]  721 		ld	b,a
      000425 3A 47 00         [13]  722 		ld	a,(col_now)
      000428 90               [ 4]  723 		sub	b
      000429 47               [ 4]  724 		ld	b,a
      00042A CB 20            [ 8]  725 		sla	b
      00042C CB 20            [ 8]  726 		sla	b	;x16 (invader width)
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 16.
Hexadecimal [24-Bits]



      00042E CB 20            [ 8]  727 		sla	b
      000430 CB 20            [ 8]  728 		sla	b
      000432 3A 09 00         [13]  729 		ld	a,(col_invaders_px)
      000435 80               [ 4]  730 		add	a,b
      000436 C6 07            [ 7]  731 		add	a,#7
      000438 DD 77 00         [19]  732 		ld	_BOMB_HPOS_PX(ix),a
                                    733 
      00043B 06 0F            [ 7]  734 		ld	b,#0x0f
      00043D CB 47            [ 8]  735 		bit	0,a
      00043F 28 02            [12]  736 		jr	z,newbomb3
      000441 06 F0            [ 7]  737 		ld	b,#0xf0
                                    738 
      000443 78               [ 4]  739 newbomb3:	ld	a,b
      000444 DD 77 08         [19]  740 		ld	_BOMB_PIXMASK(ix),a
                                    741 
      000447 DD 7E 10         [19]  742 		ld	a,_BOMB_VPOS(ix)	; Pixel line
      00044A 21 00 00         [10]  743 		ld	hl,#0
      00044D B7               [ 4]  744 		or	a
      00044E 28 07            [12]  745 		jr	z,nbupd1a
      000450 11 A0 00         [10]  746 		ld	de,#BYTES_PER_LINE
      000453 19               [11]  747 nbupd1:		add	hl,de
      000454 3D               [ 4]  748 		dec	a
      000455 20 FC            [12]  749 		jr	nz,nbupd1
                                    750 	
      000457 54               [ 4]  751 nbupd1a:	ld	d,h
      000458 5D               [ 4]  752 		ld	e,l
      000459 DD 7E 00         [19]  753 		ld	a,_BOMB_HPOS_PX(ix)
      00045C CB 3F            [ 8]  754 		srl	a
      00045E 6F               [ 4]  755 		ld	l,a
      00045F 26 00            [ 7]  756 		ld	h,#0
      000461 19               [11]  757 		add	hl,de
      000462 11 18 00         [10]  758 		ld	de,#LEFT_OFFSET_BYTES
      000465 19               [11]  759 		add	hl,de
      000466 DD 75 20         [19]  760 		ld	_BOMB_SCRPOS_L(ix),l
      000469 DD 74 28         [19]  761 		ld	_BOMB_SCRPOS_H(ix),h
                                    762 
      00046C 3E 01            [ 7]  763 		ld	a,#1
      00046E DD 77 18         [19]  764 		ld	_BOMB_ACT(ix),a
                                    765 
      000471 C9               [10]  766 		ret
                                    767 
                                    768 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    769 
      000472                        770 nb_testcol:		
                                    771 		; will test a column to launch a bomb
                                    772 		; return  # if invaders in col in D, Lowest row w/ invader in col in E
                                    773 
      000472 21 0B 00         [10]  774 		ld	hl,#invader_matrix	; top of scanned column
      000475 06 00            [ 7]  775 		ld	b,#0
      000477 3A 47 00         [13]  776 		ld	a,(col_now)
      00047A 4F               [ 4]  777 		ld	c,a
      00047B 09               [11]  778 		add	hl,bc			; H offset
      00047C 11 00 00         [10]  779 		ld	de,#0			;
      00047F 0E 00            [ 7]  780 		ld	c,#0
      000481 06 05            [ 7]  781 		ld	b,#INVADER_ROWS
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 17.
Hexadecimal [24-Bits]



      000483 7E               [ 7]  782 nbcc1:		ld	a,(hl)
      000484 B7               [ 4]  783 		or	a
      000485 28 02            [12]  784 		jr	z,nbcc2
      000487 59               [ 4]  785 		ld	e,c
      000488 14               [ 4]  786 		inc	d		
      000489 7D               [ 4]  787 nbcc2:		ld	a,l
      00048A C6 0B            [ 7]  788 		add	a,#INVADER_COLS
      00048C 6F               [ 4]  789 		ld	l,a
      00048D 30 01            [12]  790 		jr	nc,nbcc3
      00048F 24               [ 4]  791 		inc	h
      000490 0C               [ 4]  792 nbcc3:		inc	c
      000491 10 F0            [13]  793 		djnz	nbcc1
                                    794 
      000493 C9               [10]  795 		ret
                                    796 	
                                    797 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    798 
      000494                        799 move_bombs:
      000494 3A 87 00         [13]  800 		ld	a,(timer_bombs)
      000497 B7               [ 4]  801 		or	a
      000498 C0               [11]  802 		ret	nz
      000499 3E 04            [ 7]  803 		ld	a,#4
      00049B 32 87 00         [13]  804 		ld	(timer_bombs),a
                                    805 
      00049E DD 21 57 00      [14]  806 		ld	ix,#bomb_basedata
                                    807 
      0004A2 06 08            [ 7]  808 		ld	b,#NUM_BOMBS
      0004A4                        809 move_bombs1:
      0004A4 C5               [11]  810 		push	bc
      0004A5 CD AE 04         [17]  811 		call	move_bombs_ix
      0004A8 DD 23            [10]  812 		inc	ix
      0004AA C1               [10]  813 		pop	bc
      0004AB 10 F7            [13]  814 		djnz	move_bombs1
                                    815 
      0004AD C9               [10]  816 		ret
                                    817 
                                    818 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                    819 
      0004AE                        820 move_bombs_ix:
      0004AE DD 7E 18         [19]  821 		ld	a,_BOMB_ACT(ix)
      0004B1 B7               [ 4]  822 		or	a
      0004B2 C8               [11]  823 		ret	z
                                    824 
      0004B3 DD 7E 10         [19]  825 		ld	a,_BOMB_VPOS(ix)
      0004B6 FE E4            [ 7]  826 		cp	#(CANNON_VPOS+8)
      0004B8 38 0E            [12]  827 		jr	c,moveb1
                                    828 
                                    829 		; Bomb reached bottom of screen.
      0004BA AF               [ 4]  830 		xor	a
      0004BB DD 77 18         [19]  831 		ld	_BOMB_ACT(ix),a
      0004BE DD 6E 20         [19]  832 		ld	l,_BOMB_SCRPOS_L(ix)
      0004C1 DD 66 28         [19]  833 		ld	h,_BOMB_SCRPOS_H(ix)
      0004C4 0E 00            [ 7]  834 		ld	c,#0
      0004C6 18 57            [12]  835 		jr	moveb2
                                    836 
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 18.
Hexadecimal [24-Bits]



      0004C8 3C               [ 4]  837 moveb1:		inc	a
      0004C9 3C               [ 4]  838 		inc	a
      0004CA DD 77 10         [19]  839 		ld	_BOMB_VPOS(ix),a
                                    840 		
      0004CD DD 6E 20         [19]  841 		ld	l,_BOMB_SCRPOS_L(ix)
      0004D0 DD 66 28         [19]  842 		ld	h,_BOMB_SCRPOS_H(ix)
      0004D3 11 40 01         [10]  843 		ld	de,#(2*BYTES_PER_LINE)
      0004D6 19               [11]  844 		add	hl,de
      0004D7 DD 75 20         [19]  845 		ld	_BOMB_SCRPOS_L(ix),l
      0004DA DD 74 28         [19]  846 		ld	_BOMB_SCRPOS_H(ix),h
                                    847 
      0004DD DD 7E 08         [19]  848 		ld	a,_BOMB_PIXMASK(ix)
      0004E0 E6 EE            [ 7]  849 		and	#0xee
      0004E2 4F               [ 4]  850 		ld	c,a
                                    851 		
      0004E3 7D               [ 4]  852 		ld	a,l
      0004E4 D3 51            [11]  853 		out	(PORTADDRL),a
      0004E6 7C               [ 4]  854 		ld	a,h
      0004E7 D3 52            [11]  855 		out	(PORTADDRH),a
                                    856 
      0004E9 DD 7E 08         [19]  857 		ld	a,_BOMB_PIXMASK(ix)
      0004EC 57               [ 4]  858 		ld	d,a
      0004ED DB 50            [11]  859 		in	a,(PORTDATA)
      0004EF A2               [ 4]  860 		and	d
      0004F0 28 2D            [12]  861 		jr	z,moveb2
                                    862 
                                    863 		; Bomb hit something.
                                    864 
      0004F2 DD 7E 10         [19]  865 		ld	a,_BOMB_VPOS(ix)
      0004F5 FE DC            [ 7]  866 		cp	#CANNON_VPOS
      0004F7 38 1F            [12]  867 		jr	c,moveb1a	;Not the cannon
                                    868 
      0004F9 3A 01 00         [13]  869 		ld	a,(cannon_hpos_px)
      0004FC 3C               [ 4]  870 		inc	a		;Actual cannon graphics start at next column
      0004FD 4F               [ 4]  871 		ld	c,a
      0004FE DD 7E 00         [19]  872 		ld	a,_BOMB_HPOS_PX(ix)
      000501 B9               [ 4]  873 		cp	c
      000502 38 14            [12]  874 		jr	c,moveb1a	;Was at left of cannon
                                    875 
      000504 3A 01 00         [13]  876 		ld	a,(cannon_hpos_px)
      000507 C6 0D            [ 7]  877 		add	a,#13		;Cannon graphics end 13 columns after
      000509 4F               [ 4]  878 		ld	c,a
      00050A DD 7E 00         [19]  879 		ld	a,_BOMB_HPOS_PX(ix)
      00050D B9               [ 4]  880 		cp	c
      00050E 30 08            [12]  881 		jr	nc,moveb1a	;Was at right of cannon
                                    882 
      000510 E5               [11]  883 		push	hl
      000511 21 58 02         [10]  884 		ld	hl,#600
      000514 22 51 00         [16]  885 		ld	(cannondie_state),hl
      000517 E1               [10]  886 		pop	hl
                                    887 		
      000518 3E 00            [ 7]  888 moveb1a:	ld	a,#0
      00051A DD 77 18         [19]  889 		ld 	_BOMB_ACT(ix),a
      00051D 0E 00            [ 7]  890 		ld	c,#0
                                    891 		
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 19.
Hexadecimal [24-Bits]



      00051F                        892 moveb2:		; Redrawing the bomb
      00051F 06 05            [ 7]  893 		ld	b,#5
      000521 11 60 FF         [10]  894 		ld	de,#-BYTES_PER_LINE
                                    895 
      000524 7D               [ 4]  896 moveb3:		ld	a,l
      000525 D3 51            [11]  897 		out	(PORTADDRL),a
      000527 7C               [ 4]  898 		ld	a,h
      000528 D3 52            [11]  899 		out	(PORTADDRH),a
      00052A C5               [11]  900 		push	bc
      00052B DB 50            [11]  901 		in	a,(PORTDATA)
      00052D 47               [ 4]  902 		ld	b,a
      00052E DD 7E 08         [19]  903 		ld	a,_BOMB_PIXMASK(ix)
      000531 2F               [ 4]  904 		cpl
      000532 A0               [ 4]  905 		and	b
      000533 B1               [ 4]  906 		or	c
      000534 C1               [10]  907 		pop	bc
      000535 D3 50            [11]  908 		out	(PORTDATA),a
      000537 19               [11]  909 		add	hl,de
      000538 10 EA            [13]  910 		djnz	moveb3
                                    911 
      00053A 06 02            [ 7]  912 		ld	b,#2
      00053C DD 7E 08         [19]  913 		ld	a,_BOMB_PIXMASK(ix)
      00053F 2F               [ 4]  914 		cpl
      000540 4F               [ 4]  915 		ld	c,a
      000541 7D               [ 4]  916 moveb4:		ld	a,l
      000542 D3 51            [11]  917 		out	(PORTADDRL),a
      000544 7C               [ 4]  918 		ld	a,h
      000545 D3 52            [11]  919 		out	(PORTADDRH),a
      000547 DB 50            [11]  920 		in	a,(PORTDATA)
      000549 A1               [ 4]  921 		and	c
      00054A D3 50            [11]  922 		out	(PORTDATA),a
      00054C 19               [11]  923 		add	hl,de
      00054D 10 F2            [13]  924 		djnz	moveb4
      00054F C9               [10]  925 		ret
                                    926 
                                    927 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    928 
      000550 21 66 05         [10]  929 print_score:	ld	hl,#strscore
      000553 11 00 00         [10]  930 		ld	de,#0
      000556 0E 0C            [ 7]  931 		ld	c,#12	;Light red
      000558 CD 00 00         [17]  932 		call	print_string
      00055B 2A 54 00         [16]  933 		ld	hl,(score)
      00055E 11 18 00         [10]  934 		ld	de,#24
      000561 0E 09            [ 7]  935 		ld	c,#9	;Light blue
      000563 C3 00 00         [10]  936 		jp	print_number
                                    937 
      000566 53 43 4F 52 45 3A 00   938 strscore:	.ascii	'SCORE:\0'
                                    939 
                                    940 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                                    941 
      00056D                        942 sysm_printh8:	; Value in ACC
                                    943 
      00056D C5               [11]  944 		push	bc
      00056E 47               [ 4]  945 		ld	b,a
      00056F CB 3F            [ 8]  946 		srl	a
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 20.
Hexadecimal [24-Bits]



      000571 CB 3F            [ 8]  947 		srl	a
      000573 CB 3F            [ 8]  948 		srl	a
      000575 CB 3F            [ 8]  949 		srl	a
      000577 FE 0A            [ 7]  950 		cp	#10
      000579 30 04            [12]  951 		jr	nc,sysm_ph8a
      00057B C6 30            [ 7]  952 		add	a,#'0'
      00057D 18 02            [12]  953 		jr	sysm_ph8b
      00057F                        954 sysm_ph8a:
      00057F C6 37            [ 7]  955 		add	a,#'A'-10
      000581                        956 sysm_ph8b:
      000581 CF               [11]  957 		rst	0x08
                                    958 
      000582 78               [ 4]  959 		ld	a,b
      000583 E6 0F            [ 7]  960 		and	#0x0f
      000585 FE 0A            [ 7]  961 		cp	#10
      000587 30 04            [12]  962 		jr	nc,sysm_ph8c
      000589 C6 30            [ 7]  963 		add	a,#'0'
      00058B 18 02            [12]  964 		jr	sysm_ph8d
      00058D                        965 sysm_ph8c:
      00058D C6 37            [ 7]  966 		add	a,#'A'-10
      00058F                        967 sysm_ph8d:
      00058F CF               [11]  968 		rst	0x08
      000590 C1               [10]  969 		pop	bc
      000591 C9               [10]  970 		ret
                                    971 
                                    972 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;		
                                    973 
                                    974 		.area _DATA
                                    975 
      000000                        976 inputs_state: 	.ds	1
                                    977 
      000001                        978 cannon_hpos_px:	.ds	1
      000002                        979 missile_hpos_px:.ds	1
      000003                        980 missile_pixmask:.ds	1
      000004                        981 missile_vpos:	.ds	1
      000005                        982 missile_act:	.ds	1
      000006                        983 missile_scrpos:	.ds	2
                                    984 
      000008                        985 row_invaders:	.ds	1
      000009                        986 col_invaders_px:.ds	1
      00000A                        987 hdir_invaders:	.ds	1
                                    988 
      00000B                        989 invader_matrix:	.ds	INVADER_NUM
      000042                        990 invader_count:	.ds	1
      000043                        991 invader_matnow:	.ds	2
      000045                        992 col_start:	.ds	1
      000046                        993 col_end:	.ds	1
      000047                        994 col_now:	.ds	1
      000048                        995 row_end:	.ds	1
      000049                        996 timer_div:	.ds	2
      00004B                        997 timer_invaders:	.ds	2
      00004D                        998 invaders_divider:.ds	2
      00004F                        999 timer_cannon:	.ds	1
      000050                       1000 timer_missile:	.ds	1
      000051                       1001 cannondie_state:.ds	2
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180 / ZX-Next / eZ80), page 21.
Hexadecimal [24-Bits]



      000053                       1002 refsh_cannon:	.ds	1
      000054                       1003 score:		.ds	2
      000056                       1004 scrinc:		.ds	1
                                   1005 
                                   1006 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
      000057                       1007 bomb_basedata:
      000057                       1008 bomb_hpos_px:	.ds	NUM_BOMBS
      00005F                       1009 bomb_pixmask:	.ds	NUM_BOMBS
      000067                       1010 bomb_vpos:	.ds	NUM_BOMBS
      00006F                       1011 bomb_act:	.ds	NUM_BOMBS
      000077                       1012 bomb_scrpos_l:	.ds	NUM_BOMBS
      00007F                       1013 bomb_scrpos_h:	.ds	NUM_BOMBS
                                   1014 
                           000000  1015 _BOMB_HPOS_PX	.equ	(bomb_hpos_px - bomb_basedata)
                           000008  1016 _BOMB_PIXMASK	.equ	(bomb_pixmask - bomb_basedata)
                           000010  1017 _BOMB_VPOS	.equ	(bomb_vpos - bomb_basedata)
                           000018  1018 _BOMB_ACT	.equ	(bomb_act - bomb_basedata)
                           000020  1019 _BOMB_SCRPOS_L	.equ	(bomb_scrpos_l - bomb_basedata)
                           000028  1020 _BOMB_SCRPOS_H	.equ	(bomb_scrpos_h - bomb_basedata)
                                   1021 
      000087                       1022 timer_bombs:	.ds	1
      000088                       1023 timer_newbomb:	.ds	1
                                   1024 
      000089                       1025 lfsr_data:	.ds	2
                                   1026 
